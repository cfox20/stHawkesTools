% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/parametric_bootstrap.R
\name{parametric_bootstrap}
\alias{parametric_bootstrap}
\title{Parametric bootstrap for Hawkes MLE confidence intervals}
\usage{
parametric_bootstrap(
  hawkes,
  est,
  B,
  alpha = 0.05,
  parallel = FALSE,
  max_iters = 500,
  boundary = NULL,
  temporal_burnin = NULL,
  spatial_burnin = NULL
)
}
\arguments{
\item{hawkes}{A \code{hawkes} object.}

\item{est}{A \code{hawkes_mle} object providing initial parameter estimates.}

\item{B}{Number of bootstrap iterations. At least 1000 is recommended.}

\item{alpha}{Significance level for confidence intervals. Defaults to 0.05.}

\item{parallel}{Logical flag for \pkg{furrr} based parallel computation. Configure a
multisession plan before calling when \code{TRUE}.}

\item{max_iters}{Maximum EM iterations for each refit. Defaults to 500.}

\item{boundary}{Optional boundary width used for edge correction.}

\item{temporal_burnin}{Temporal burn-in used when simulating bootstrap samples.}

\item{spatial_burnin}{Spatial burn-in radius used when simulating bootstrap samples.}
}
\value{
A tibble of bootstrap summary statistics.
}
\description{
Parametric bootstrap for Hawkes MLE confidence intervals
}
\examples{
params <- list(
  background_rate = list(intercept = -4.5, X1 = 1, X2 = 1),
  triggering_rate = 0.5,
  spatial = list(mean = 0, sd = 0.25),
  temporal = list(rate = 2),
  fixed = list(spatial = "mean")
)
data("example_background_covariates")
hawkes <- rHawkes(
  params,
  c(0, 50),
  example_background_covariates,
  covariate_columns = c("X1", "X2"),
  spatial_burnin = 1
)
est <- hawkes_mle(hawkes, inits = params, boundary = 1)

# Demonstration with few bootstrap iterations (use at least 1000 in practice)
parametric_bootstrap(hawkes, est, B = 5, boundary = c(0.5, 3))


params <- list(
  background_rate = list(intercept = -4.5, X1 = 1, X2 = 1),
  triggering_rate = 0.5,
  spatial = list(mean = 0, sd = 0.25),
  temporal = list(rate = 2),
  fixed = list(spatial = "mean")
)
data("example_background_covariates")
hawkes <- rHawkes(
  params,
  c(0, 50),
  example_background_covariates,
  covariate_columns = c("X1", "X2"),
  spatial_burnin = 1
)
est <- hawkes_mle(hawkes, inits = params, boundary = 1)

future::plan(future::multisession, workers = future::availableCores())

parametric_bootstrap(hawkes, est, B = 2, parallel = TRUE, boundary = c(0.5, 3))

future::plan(future::sequential)
}
